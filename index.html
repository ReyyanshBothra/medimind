<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Medimind</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black text-white">
  <div id="root"></div>

  <!-- React and Babel -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    const { useState, useRef, useEffect } = React;

    function Medimind() {
      const [isPlaying, setIsPlaying] = useState(false);
      const [showGrid, setShowGrid] = useState(false);
      const [pattern, setPattern] = useState('fractal');
      const audioRef = useRef(null);
      const canvasRef = useRef(null);
      const animationRef = useRef(null);

      const drawFractal = (ctx, width, height, t) => {
        ctx.clearRect(0, 0, width, height);
        ctx.strokeStyle = `hsl(${(t / 10) % 360}, 100%, 70%)`;
        ctx.lineWidth = 2;
        ctx.save();
        ctx.translate(width / 2, height / 2);
        for (let i = 0; i < 100; i++) {
          const angle = (Math.PI * 2 * i) / 100;
          const radius = 100 * Math.sin(t / 50 + i / 5);
          ctx.beginPath();
          ctx.moveTo(0, 0);
          ctx.lineTo(radius * Math.cos(angle), radius * Math.sin(angle));
          ctx.stroke();
        }
        ctx.restore();
      };

      const drawGoldenSpiral = (ctx, width, height, t) => {
        ctx.clearRect(0, 0, width, height);
        ctx.strokeStyle = `hsl(${(t / 20) % 360}, 70%, 60%)`;
        ctx.lineWidth = 2;
        ctx.save();
        ctx.translate(width / 2, height / 2);
        const phi = 1.618;
        for (let i = 0; i < 200; i++) {
          const angle = 0.1 * i;
          const r = 2 * Math.pow(phi, angle / (2 * Math.PI));
          ctx.lineTo(r * Math.cos(angle + t / 100), r * Math.sin(angle + t / 100));
        }
        ctx.stroke();
        ctx.restore();
      };

      const drawGridOverlay = (ctx, width, height) => {
        if (!showGrid) return;
        ctx.strokeStyle = "rgba(255,255,255,0.1)";
        for (let x = 0; x < width; x += 50) {
          ctx.beginPath();
          ctx.moveTo(x, 0);
          ctx.lineTo(x, height);
          ctx.stroke();
        }
        for (let y = 0; y < height; y += 50) {
          ctx.beginPath();
          ctx.moveTo(0, y);
          ctx.lineTo(width, y);
          ctx.stroke();
        }
      };

      useEffect(() => {
        const canvas = canvasRef.current;
        const ctx = canvas.getContext("2d");
        let t = 0;
        const render = () => {
          const { width, height } = canvas;
          ctx.clearRect(0, 0, width, height);
          if (pattern === "fractal") drawFractal(ctx, width, height, t);
          else drawGoldenSpiral(ctx, width, height, t);
          drawGridOverlay(ctx, width, height);
          t += 1;
          animationRef.current = requestAnimationFrame(render);
        };
        render();
        return () => cancelAnimationFrame(animationRef.current);
      }, [pattern, showGrid]);

      const togglePlay = () => {
        const audio = audioRef.current;
        if (isPlaying) audio.pause();
        else audio.play();
        setIsPlaying(!isPlaying);
      };

      return (
        <div className="flex flex-col items-center justify-center min-h-screen p-4 space-y-4">
          <h1 className="text-4xl font-bold text-purple-300 mb-2">üßò‚Äç‚ôÇÔ∏è Medimind</h1>
          <canvas ref={canvasRef} width={600} height={400} className="rounded-2xl shadow-lg border border-purple-500"></canvas>
          <div className="flex space-x-4 mt-4">
            <button onClick={togglePlay} className="bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-xl">
              {isPlaying ? "Pause Meditation" : "Play Meditation"}
            </button>
            <button onClick={() => setShowGrid(!showGrid)} className="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-xl">
              {showGrid ? "Hide Grid" : "Show Grid"}
            </button>
            <button onClick={() => setPattern(pattern === 'fractal' ? 'golden' : 'fractal')} className="bg-green-600 hover:bg-green-700 px-4 py-2 rounded-xl">
              Switch Pattern
            </button>
          </div>
          <audio ref={audioRef} src="https://cdn.pixabay.com/download/audio/2023/04/19/audio_3f69c36d4f.mp3?filename=calm-mind-145009.mp3" loop></audio>
          <p className="text-gray-400 text-sm mt-4">Fractal visuals inspired by the Golden Ratio ‚ú®</p>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<Medimind />);
  </script>
</body>
</html>
